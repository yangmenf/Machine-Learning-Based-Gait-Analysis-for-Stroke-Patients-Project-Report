# 用户使用指南

## 📋 系统架构

### 技术架构图

```
┌─────────────────────────────────────────────────────────────────┐
│                        输入数据层                                │
├─────────────────────────────────────────────────────────────────┤
│  MAT文件(健康人)  │  MAT文件(中风患者)  │  Excel说明文件        │
│     138人×6组     │      50人×6组       │    变量定义          │
└─────────────────────────────────────────────────────────────────┘
                                │
                                ▼
┌─────────────────────────────────────────────────────────────────┐
│                        数据处理层                                │
├─────────────────────────────────────────────────────────────────┤
│  HDF5解析器  │  特征提取器  │  数据清洗器  │  标准化器          │
│   h5py库     │   统计计算   │   缺失值处理  │   Z-score         │
└─────────────────────────────────────────────────────────────────┘
                                │
                                ▼
┌─────────────────────────────────────────────────────────────────┐
│                        分析算法层                                │
├─────────────────────────────────────────────────────────────────┤
│   分类算法   │   回归算法   │   统计检验   │   效应量计算        │
│  随机森林    │   岭回归     │   t检验      │   Cohen's d        │
│  逻辑回归    │   Lasso     │   方差分析   │   置信区间          │
│   SVM       │   线性回归   │   正态检验   │   功效分析          │
└─────────────────────────────────────────────────────────────────┘
                                │
                                ▼
┌─────────────────────────────────────────────────────────────────┐
│                        可视化层                                  │
├─────────────────────────────────────────────────────────────────┤
│  分类图表    │  回归图表    │  统计图表    │  报告生成          │
│  性能对比    │  效应量图    │  分布图      │  Markdown         │
│  混淆矩阵    │  散点图      │  箱线图      │  图表说明          │
└─────────────────────────────────────────────────────────────────┘
                                │
                                ▼
┌─────────────────────────────────────────────────────────────────┐
│                        输出结果层                                │
├─────────────────────────────────────────────────────────────────┤
│  分类模型    │  差异特征    │  可视化图表  │  技术报告          │
│  98.2%准确率 │  197个特征   │  PNG格式     │  详细分析          │
│  临床应用级  │  统计显著    │  高分辨率    │  临床指导          │
└─────────────────────────────────────────────────────────────────┘
```

## 🚀 快速开始

### 环境准备

1. **Python 环境**: 确保安装 Python 3.7+
2. **依赖安装**:

```bash
pip install numpy==1.24.3 h5py==3.8.0 scipy==1.10.1
pip install scikit-learn matplotlib seaborn pandas
```

### 完整分析流程

#### 步骤 1: 数据转换（可选）

如果需要重新转换 MAT 文件：

```bash
cd scripts
python complete_mat_converter.py
```

**输出**: `data/complete_gait_features.csv`

#### 步骤 2: 分类分析

```bash
python complete_data_analysis.py
```

**输出**:

- `results/complete_mat_analysis.png`
- `docs/complete_mat_analysis_report.md`

#### 步骤 3: 回归分析

```bash
python regression_analysis.py
```

**输出**:

- `results/regression_analysis.png`
- `docs/regression_analysis_report.md`

#### 步骤 4: 字体修复（如需要）

如果图表中文显示异常：

```bash
python fix_chinese_font.py
```

## 📊 结果解读

### 分类结果

- **准确率>95%**: 模型性能优秀，可用于临床
- **混淆矩阵**: 查看具体分类错误情况
- **特征重要性**: 识别关键步态参数

### 回归结果

- **效应量>0.8**: 临床意义重大的差异特征
- **p<0.05**: 统计学显著的差异
- **R²>0.8**: 回归模型解释能力强

## ⚠️ 注意事项

1. **内存要求**: 建议 8GB+内存
2. **运行时间**: 完整分析约需 5-10 分钟
3. **文件路径**: 确保在 scripts 目录下运行
4. **数据完整性**: 确保 MAT 文件完整无损

## 🔧 故障排除

### 常见问题

**Q: 中文显示乱码**
A: 运行 `python fix_chinese_font.py`

**Q: 内存不足**
A: 关闭其他程序，或使用更高配置的计算机

**Q: 图表无法生成**
A: 检查 matplotlib 版本，运行可视化修复脚本

**Q: MAT 文件读取失败**
A: 确认文件格式为 MATLAB v7.3，检查文件完整性
